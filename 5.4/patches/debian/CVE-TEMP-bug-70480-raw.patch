From: Stanislav Malyshev <stas@php.net>
Date: Mon, 28 Sep 2015 18:31:14 +0000 (-0700)
Subject: Fix bug #70480 (php_url_parse_ex() buffer overflow read)
X-Git-Tag: php-5.6.15RC1~25
X-Git-Url: https://72.52.91.13:4430/?p=php-src.git;a=commitdiff_plain;h=629e4da7cc8b174acdeab84969cbfc606a019b31

Fix bug #70480 (php_url_parse_ex() buffer overflow read)
---

Index: php5-5.4.45/ext/standard/url.c
===================================================================
--- php5-5.4.45.orig/src/ext/standard/url.c	2016-06-19 11:58:54.000000000 +0200
+++ php5-5.4.45/src/ext/standard/url.c	2016-06-19 11:58:54.000000000 +0200
@@ -321,7 +321,7 @@
 	nohost:
 	
 	if ((p = memchr(s, '?', (ue - s)))) {
-		pp = strchr(s, '#');
+		pp = memchr(s, '#', (ue - s));
 
 		if (pp && pp < p) {
 			if (pp - s) {
