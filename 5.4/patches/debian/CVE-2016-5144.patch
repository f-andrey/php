Index: php5-5.4.45/sapi/fpm/fpm/fpm_log.c
===================================================================
--- php5-5.4.45.orig/src/sapi/fpm/fpm/fpm_log.c	2016-06-19 11:39:45.000000000 +0200
+++ php5-5.4.45/src/sapi/fpm/fpm/fpm_log.c	2016-06-19 11:39:45.000000000 +0200
@@ -446,6 +446,11 @@
 				b += len2;
 				len += len2;
 			}
+			if (len >= FPM_LOG_BUFFER) {
+				zlog(ZLOG_NOTICE, "the log buffer is full (%d). The access log request has been truncated.", FPM_LOG_BUFFER);
+				len = FPM_LOG_BUFFER;
+				break;
+			}
 			continue;
 		}
 
