--- php53-5.3.29/src/ext/fileinfo/libmagic/cdf.c.orig	2014-08-13 23:22:50.000000000 +0400
+++ php53-5.3.29/src/ext/fileinfo/libmagic/cdf.c	2014-11-21 16:16:01.000000000 +0300
@@ -820,7 +820,7 @@
 		q = (const uint8_t *)(const void *)
 		    ((const char *)(const void *)p + ofs
 		    - 2 * sizeof(uint32_t));
-		if (q > e) {
+		if (q < p || q > e) {
 			DPRINTF(("Ran of the end %p > %p\n", q, e));
 			goto out;
 		}
