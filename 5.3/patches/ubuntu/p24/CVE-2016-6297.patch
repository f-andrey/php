Description: fix integer overflow in php_stream_zip_opener
Origin: backport, http://git.php.net/?p=php-src.git;a=commit;h=81406c0c1d45f75fcc7972ed974d2597abb0b9e9
Origin: backport, http://git.php.net/?p=php-src.git;a=commit;h=8ebdb1f5fd19cb15dd6ac7700c781ede5dcbba95
Bug: https://bugs.php.net/bug.php?id=72520

Index: php5-5.5.9+dfsg/ext/zip/zip_stream.c
===================================================================
--- php5-5.5.9+dfsg.orig/src/ext/zip/zip_stream.c	2014-02-05 05:00:36.000000000 -0500
+++ php5-5.5.9+dfsg/src/ext/zip/zip_stream.c	2016-07-28 08:55:59.659839504 -0400
@@ -101,13 +101,13 @@
 {
 	struct zip_stat sb;
 	const char *path = stream->orig_path;
-	int path_len = strlen(stream->orig_path);
+	size_t path_len = strlen(stream->orig_path);
 	char *file_basename;
 	size_t file_basename_len;
 	char file_dirname[MAXPATHLEN];
 	struct zip *za;
 	char *fragment;
-	int fragment_len;
+	size_t fragment_len;
 	int err;
 
 	fragment = strchr(path, '#');
@@ -241,7 +241,7 @@
 											char **opened_path,
 											php_stream_context *context STREAMS_DC TSRMLS_DC)
 {
-	int path_len;
+	size_t path_len;
 
 	char *file_basename;
 	size_t file_basename_len;
@@ -250,7 +250,7 @@
 	struct zip *za;
 	struct zip_file *zf = NULL;
 	char *fragment;
-	int fragment_len;
+	size_t fragment_len;
 	int err;
 
 	php_stream *stream = NULL;
