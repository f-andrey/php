From 6d55ba265637d6adf0ba7e9c9ef11187d1ec2f5b Mon Sep 17 00:00:00 2001
From: Stanislav Malyshev <stas@php.net>
Date: Mon, 5 Sep 2016 18:01:35 -0700
Subject: [PATCH] Fix bug #73007: add locale length check

---
 ext/intl/msgformat/msgformat_format.c | 2 ++
 1 file changed, 2 insertions(+)

Index: php5-5.3.10/src/ext/intl/msgformat/msgformat_format.c
===================================================================
--- php5-5.3.10.orig/src/ext/intl/msgformat/msgformat_format.c	2016-09-30 07:47:22.839937397 -0400
+++ php5-5.3.10/src/ext/intl/msgformat/msgformat_format.c	2016-09-30 07:47:22.835937352 -0400
@@ -135,6 +135,8 @@
 		RETURN_FALSE;
 	}
 
+	INTL_CHECK_LOCALE_LEN(slocale_len);
+
 	msgformat_data_init(&mfo->mf_data TSRMLS_CC);
 
 	if(pattern && pattern_len) {
