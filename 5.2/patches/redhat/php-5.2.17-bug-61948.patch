diff -up php-5.2.17/ext/curl/interface.c.bug-61948 php-5.2.17/ext/curl/interface.c
--- php-5.2.17/src/ext/curl/interface.c.bug-61948	2012-07-23 03:15:05.000000000 -0400
+++ php-5.2.17/src/ext/curl/interface.c	2012-07-23 03:15:26.000000000 -0400
@@ -1720,7 +1720,7 @@ static int _php_curl_setopt(php_curl *ch
 
 			convert_to_string_ex(zvalue);
 
-			if (php_check_open_basedir(Z_STRVAL_PP(zvalue) TSRMLS_CC) || (PG(safe_mode) && !php_checkuid(Z_STRVAL_PP(zvalue), "rb+", CHECKUID_CHECK_MODE_PARAM))) {
+			if (!Z_STRLEN_PP(zvalue) || php_check_open_basedir(Z_STRVAL_PP(zvalue) TSRMLS_CC) || (PG(safe_mode) && !php_checkuid(Z_STRVAL_PP(zvalue), "rb+", CHECKUID_CHECK_MODE_PARAM))) {
 				RETVAL_FALSE;
 				return 1;
 			}
