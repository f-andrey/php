diff -up php-5.2.17/main/SAPI.c.bug-60227 php-5.2.17/main/SAPI.c
--- php-5.2.17/src/main/SAPI.c.bug-60227	2012-05-03 23:19:19.000000000 -0400
+++ php-5.2.17/src/main/SAPI.c	2012-05-03 23:19:35.000000000 -0400
@@ -570,7 +570,7 @@ SAPI_API int sapi_header_op(sapi_header_
 	/* new line safety check */
 	{
 		char *s = header_line, *e = header_line + header_line_len, *p;
-		while (s < e && (p = memchr(s, '\n', (e - s)))) {
+		while (s < e && ((p = memchr(s, '\n', (e - s))) || (p = memchr(s, '\r', (e - s))))) {
 			if (*(p + 1) == ' ' || *(p + 1) == '\t') {
 				s = p + 1;
 				continue;
