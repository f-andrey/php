diff -up php-5.2.17/ext/pdo_sqlite/sqlite_driver.c.CVE-2012-3365 php-5.2.17/ext/pdo_sqlite/sqlite_driver.c
--- php-5.2.17/src/ext/pdo_sqlite/sqlite_driver.c.CVE-2012-3365	2012-07-22 22:52:40.000000000 -0400
+++ php-5.2.17/src/ext/pdo_sqlite/sqlite_driver.c	2012-07-22 22:53:12.000000000 -0400
@@ -642,7 +642,7 @@ static struct pdo_dbh_methods sqlite_met
 
 static char *make_filename_safe(const char *filename TSRMLS_DC)
 {
-	if (*filename && strncmp(filename, ":memory:", sizeof(":memory:")-1)) {
+	if (*filename && memcmp(filename, ":memory:", sizeof(":memory:"))) {
 		char *fullpath = expand_filepath(filename, NULL TSRMLS_CC);
 
 		if (!fullpath) {
diff -up php-5.2.17/ext/sqlite/sqlite.c.CVE-2012-3365 php-5.2.17/ext/sqlite/sqlite.c
--- php-5.2.17/src/ext/sqlite/sqlite.c.CVE-2012-3365	2012-07-22 22:53:53.000000000 -0400
+++ php-5.2.17/src/ext/sqlite/sqlite.c	2012-07-22 22:55:06.000000000 -0400
@@ -747,7 +747,7 @@ static int php_sqlite_authorizer(void *a
 			return SQLITE_OK;
 #ifdef SQLITE_ATTACH
 		case SQLITE_ATTACH:
-			if (strncmp(arg3, ":memory:", sizeof(":memory:") - 1)) {
+			if (memcmp(arg3, ":memory:", sizeof(":memory:")) && *arg3) {
 				TSRMLS_FETCH();
 				if (PG(safe_mode) && (!php_checkuid(arg3, NULL, CHECKUID_CHECK_FILE_AND_DIR))) {
 					return SQLITE_DENY;
@@ -1230,7 +1230,7 @@ PHP_FUNCTION(sqlite_popen)
 		ZVAL_NULL(errmsg);
 	}
 
-	if (strncmp(filename, ":memory:", sizeof(":memory:") - 1)) {
+	if (memcmp(filename, ":memory:", sizeof(":memory:")) != 0) {
 		/* resolve the fully-qualified path name to use as the hash key */
 		if (!(fullpath = expand_filepath(filename, NULL TSRMLS_CC))) {
 			RETURN_FALSE;
@@ -1306,7 +1306,7 @@ PHP_FUNCTION(sqlite_open)
 		ZVAL_NULL(errmsg);
 	}
 
-	if (strncmp(filename, ":memory:", sizeof(":memory:") - 1)) {
+	if (memcmp(filename, ":memory:", sizeof(":memory:")) != 0) {
 		/* resolve the fully-qualified path name to use as the hash key */
 		if (!(fullpath = expand_filepath(filename, NULL TSRMLS_CC))) {
 			php_std_error_handling();
@@ -1358,7 +1358,7 @@ PHP_FUNCTION(sqlite_factory)
 		ZVAL_NULL(errmsg);
 	}
 
-	if (strncmp(filename, ":memory:", sizeof(":memory:") - 1)) {
+	if (memcmp(filename, ":memory:", sizeof(":memory:")) != 0) {
 		/* resolve the fully-qualified path name to use as the hash key */
 		if (!(fullpath = expand_filepath(filename, NULL TSRMLS_CC))) {
 			php_std_error_handling();
