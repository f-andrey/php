diff -up php-5.2.17/ext/standard/html.c.bug-61713 php-5.2.17/ext/standard/html.c
--- php-5.2.17/src/ext/standard/html.c.bug-61713	2012-07-23 02:48:53.000000000 -0400
+++ php-5.2.17/src/ext/standard/html.c	2012-07-23 02:49:55.000000000 -0400
@@ -794,8 +794,11 @@ static enum entity_charset determine_cha
 					charset_hint = NULL;
 					len = 0;
 				}
+			} else {
+				/* Jump to det_charset only if mbstring isn't one of above eq pass, auto, none.
+				    Otherwise try default_charset next */
+				goto det_charset;
 			}
-			goto det_charset;
 		}
 	}
 #endif
