diff -up php-5.2.17/main/rfc1867.c.bug-54374 php-5.2.17/main/rfc1867.c
--- php-5.2.17/src/main/rfc1867.c.bug-54374	2012-05-03 23:38:08.000000000 -0400
+++ php-5.2.17/src/main/rfc1867.c	2012-05-03 23:38:46.000000000 -0400
@@ -1009,6 +1009,10 @@ SAPI_API SAPI_POST_HANDLER_FUNC(rfc1867_
 					}
 					tmp++;
 				}
+				/* Brackets should always be closed */
+				if(c != 0) {
+					skip_upload = 1;
+				}
 			}
 
 			total_bytes = cancel_upload = 0;
