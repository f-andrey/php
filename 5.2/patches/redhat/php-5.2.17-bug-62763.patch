diff -up php-5.2.17/ext/standard/basic_functions.c.bug-62763 php-5.2.17/ext/standard/basic_functions.c
--- php-5.2.17/src/ext/standard/basic_functions.c.bug-62763	2012-08-21 12:02:57.000000000 +0700
+++ php-5.2.17/src/ext/standard/basic_functions.c	2012-08-21 12:03:34.000000000 +0700
@@ -5446,8 +5446,11 @@ void php_free_shutdown_functions(TSRMLS_
 			zend_hash_destroy(BG(user_shutdown_function_names));
 			FREE_HASHTABLE(BG(user_shutdown_function_names));
 			BG(user_shutdown_function_names) = NULL;
-		}
-		zend_end_try();
+               } zend_catch {
+                       /* maybe shutdown method call exit, we just ignore it */
+                       FREE_HASHTABLE(BG(user_shutdown_function_names));
+                       BG(user_shutdown_function_names) = NULL;
+               } zend_end_try();
 }
 
 /* {{{ proto void register_shutdown_function(string function_name)
