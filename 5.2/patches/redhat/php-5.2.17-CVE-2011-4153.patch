diff -up php-5.2.17/ext/standard/syslog.c.CVE-2011-4153 php-5.2.17/ext/standard/syslog.c
--- php-5.2.17/src/ext/standard/syslog.c.CVE-2011-4153	2012-08-24 11:24:52.000000000 +0700
+++ php-5.2.17/src/ext/standard/syslog.c	2012-08-24 11:25:41.000000000 +0700
@@ -234,6 +234,9 @@ PHP_FUNCTION(openlog)
 		free(BG(syslog_device));
 	}
 	BG(syslog_device) = zend_strndup(ident, ident_len);
+	if(BG(syslog_device) == NULL) {
+	    RETURN_FALSE;
+	}
 	openlog(BG(syslog_device), option, facility);
 	RETURN_TRUE;
 }
diff -up php-5.2.17/Zend/zend_builtin_functions.c.CVE-2011-4153 php-5.2.17/Zend/zend_builtin_functions.c
--- php-5.2.17/src/Zend/zend_builtin_functions.c.CVE-2011-4153	2012-08-24 11:26:35.000000000 +0700
+++ php-5.2.17/src/Zend/zend_builtin_functions.c	2012-08-24 11:27:01.000000000 +0700
@@ -514,6 +514,9 @@ repeat:
 	}
 	c.flags = case_sensitive; /* non persistent */
 	c.name = zend_strndup(name, name_len);
+	if (c.name == NULL) {
+		RETURN_FALSE;
+	}
 	c.name_len = name_len+1;
 	c.module_number = PHP_USER_CONSTANT;
 	if (zend_register_constant(&c TSRMLS_CC) == SUCCESS) {
