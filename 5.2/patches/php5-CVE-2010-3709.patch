Subject: fix Fixed NULL pointer dereference in ZipArchive::getArchiveComment
Origin: http://svn.php.net/viewvc?view=revision&revision=304505

CVE-2010-3709
report & patch from Maksymilian Arciemowicz

---
 ext/zip/php_zip.c |    3 +++
 1 file changed, 3 insertions(+)

--- a/src/ext/zip/php_zip.c
+++ b/src/ext/zip/php_zip.c
@@ -1832,6 +1832,9 @@
 	}
 
 	comment = zip_get_archive_comment(intern, &comment_len, (int)flags);
+	if(comment==NULL) {
+		RETURN_FALSE;
+	}
 	RETURN_STRINGL((char *)comment, (long)comment_len, 1);
 }
 /* }}} */
